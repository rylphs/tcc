<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	template="/WEB-INF/templates/default.xhtml"
	xmlns:p="http://primefaces.org/ui"
	xmlns:b="http://bootsfaces.net/ui">
	<ui:define name="content">
		<h:form id="frm-produtos">
			<p:outputPanel styleClass="panel-wrapper">
				<h1>Produtos</h1>
				<p:dataTable value="#{listagemProdutoMB.produtos}" var="produto" selectionMode="single"
					selection="#{listagemProdutoMB.produtoSelecionado}" rowKey="#{produto.id}" paginator="true" rows="10" 
					rowsPerPageTemplate="5,10,15">
					<p:column headerText="Produto "><h:outputText value="#{produto.nome}" /></p:column>
					<p:column headerText="Custo"><h:outputText value="#{produto.custo}" /></p:column>
					<p:column headerText="Impostos"><h:outputText value="0.0" /></p:column>
					<p:column headerText="Comissões"><h:outputText value="#{produto.comissao}" /></p:column>
					<p:column headerText="Lucro"><h:outputText value="#{produto.lucro}" /></p:column>
					<p:column headerText="Preço de venda"><h:outputText value="#{produto.custo}" /></p:column>
					<p:ajax event="rowDblselect" update=":frm-novo-produto" oncomplete="PF('novo-produto').show()" />
				</p:dataTable>
				<p:commandButton value="Novo" action="#{listagemProdutoMB.prepararAdicaoProduto}"
					onsuccess="PF('novo-produto').show()" update=":frm-novo-produto :frm-produtos" icon="fa fa-plus"/>
			</p:outputPanel>
		</h:form>
		

		<p:dialog header="Novo Produto"  widgetVar="novo-produto" resizable="false" modal="true" dynamic="true">
			<h:form id="frm-novo-produto">
				<div class="ui-grid dialog-form-top">
					<p:messages autoUpdate="true"/>
					<div class="ui-grid-row">
						<p:outputLabel value="Nome:" styleClass="ui-grid-col-3 input-label"/>
						<p:inputText value="#{listagemProdutoMB.produtoSelecionado.nome}" size="50" styleClass="ui-grid-col-9"/>
					</div>
					<div class="ui-grid-row">
						<p:outputLabel value="Custo (R$): " styleClass="ui-grid-col-4 input-label"/>
						<p:inputText required="true" label="Custo"  value="#{listagemProdutoMB.produtoSelecionado.custo}" size="10" styleClass="ui-grid-col-4"/>
						<p:outputLabel value="Lucro (%): " styleClass="ui-grid-col-4 input-label"/>
						<p:inputText value="#{listagemProdutoMB.produtoSelecionado.lucro}" size="10" styleClass="ui-grid-col-4"/>
					</div>
					<div class="ui-grid-row">
						<p:outputLabel value="Comissão (%): " styleClass="ui-grid-col-4 input-label"/>
						<p:inputText value="#{listagemProdutoMB.produtoSelecionado.comissao}" styleClass="ui-grid-col-4" size="10"/>
						<span class="ui-grid-col-4"/><span class="ui-grid-col-4"/>
					</div>
					
					<div class="ui-grid-row centered-button">
						<div class="ui-grid-col-6">
							<p:commandButton value="Adicionar" action="#{listagemProdutoMB.adicionarProduto}" 
								oncomplete="if (args &amp;&amp; !args.validationFailed) PF('novo-produto').hide()" rendered="#{!listagemProdutoMB.editing}" update=":frm-produtos"/>
							<p:commandButton value="Atualizar" rendered="#{listagemProdutoMB.editing}" 
								oncomplete="console.log(args); if (args &amp;&amp; !args.validationFailed) PF('novo-produto').hide()" update=":frm-produtos"/>
						</div>
						<div class="ui-grid-col-6">
						<p:commandButton value="Cancelar" onclick="PF('novo-produto').hide()"/>
						</div>
					</div>
				</div>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>
